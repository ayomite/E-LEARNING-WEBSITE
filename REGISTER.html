<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Student Registration</title>
<style>
body { font-family: Arial,sans-serif; background:#eef2f7; display:flex; justify-content:center; align-items:center; min-height:100vh; }
.container { background:#fff; width:90%; max-width:700px; padding:40px 30px; border-radius:10px; box-shadow:0 6px 20px rgba(0,0,0,0.1); }
h2 { text-align:center; color:#0066ff; margin-bottom:30px; }
fieldset { margin-bottom:25px; border:1px solid #ccc; padding:20px 25px; border-radius:8px; }
legend { font-weight:bold; color:#0066ff; padding:0 10px; }
.form-group { margin-bottom:15px; }
label { display:block; font-weight:bold; margin-bottom:5px; }
input, select, textarea { width:100%; padding:12px; border:1px solid #ccc; border-radius:6px; outline:none; font-size:16px; }
input:focus, select:focus, textarea:focus { border-color:#0066ff; }
button { width:100%; padding:15px; background:#0066ff; color:#fff; font-size:18px; font-weight:bold; border:none; border-radius:6px; cursor:pointer; margin-top:15px; }
button:hover { background:#004fcc; }
.error-message { color:red; margin-bottom:15px; text-align:center; }
.success-message { color:green; margin-bottom:15px; text-align:center; }
</style>
</head>
<body>

<div class="container">
<h2>Student Registration</h2>
<div class="error-message" id="errorMsg"></div>
<div class="success-message" id="successMsg"></div>

<form id="registrationForm">
    <fieldset>
        <legend>Account Info</legend>
        <div class="form-group"><label>Username</label><input type="text" id="username" required></div>
        <div class="form-group"><label>Email</label><input type="email" id="email" required></div>
        <div class="form-group"><label>Password</label><input type="password" id="password" required></div>
    </fieldset>

    <fieldset>
        <legend>Student Info</legend>
        <div class="form-group"><label>Full Name</label><input type="text" name="studentName" required></div>
        <div class="form-group"><label>Date of Birth</label><input type="date" name="dob" required></div>
        <div class="form-group"><label>Gender</label><select name="gender" required><option value="" disabled selected>Select gender</option><option>Male</option><option>Female</option></select></div>
        <div class="form-group"><label>Class</label><input type="text" name="classApplying" required></div>
    </fieldset>

    <fieldset>
        <legend>Contact Info</legend>
        <div class="form-group"><label>Phone</label><input type="tel" name="phone" required></div>
        <div class="form-group"><label>Address</label><textarea name="address" rows="3" required></textarea></div>
    </fieldset>

    <button type="submit">Register</button>
</form>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, setDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDwqKHykKby2Hl4kq9YgvuE5D-m39o8s-A",
  authDomain: "registration-portal-a9e15.firebaseapp.com",
  projectId: "registration-portal-a9e15"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const form = document.getElementById("registrationForm");
const errorMsg = document.getElementById("errorMsg");
const successMsg = document.getElementById("successMsg");

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  errorMsg.innerText = "";
  successMsg.innerText = "";

  try {
    const username = document.getElementById("username").value.trim();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    const fullName = form.studentName.value.trim();
    const dob = form.dob.value;
    const gender = form.gender.value;
    const studentClass = form.classApplying.value.trim();
    const phone = form.phone.value.trim();
    const address = form.address.value.trim();

    const userCredential = await createUserWithEmailAndPassword(auth, email, password);

    await setDoc(doc(db, "students", userCredential.user.uid), {
      username, email, fullName, dob, gender, studentClass, phone, address, createdAt: new Date()
    });

    successMsg.innerText = "Registration successful! Redirecting to login...";
    form.reset();
    setTimeout(() => { window.location.href = "login.html"; }, 2000);

  } catch (error) {
    if(error.code==="auth/email-already-in-use") {
      errorMsg.innerHTML = 'Email already registered. <a href="login.html">Login here</a>';
    } else { errorMsg.innerText = error.message; }
  }
});
</script>

</body>
</html>
