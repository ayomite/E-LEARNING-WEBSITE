<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Student Dashboard</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #eef2f7;
    margin: 0;
    padding: 0;
  }

  .header {
    background: #0066ff;
    color: white;
    padding: 20px;
    text-align: center;
    font-size: 22px;
  }

  .dashboard {
    max-width: 500px;
    margin: 40px auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 3px 12px rgba(0,0,0,0.1);
  }

  h3 {
    margin-bottom: 20px;
    color: #333;
  }

  .info {
    background: #f5f8ff;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    line-height: 1.7em;
  }

  button {
    width: 100%;
    padding: 12px;
    background: #ff3333;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
  }

  button:hover {
    background: #cc0000;
  }
</style>
</head>
<body>

<div class="header">Student Dashboard</div>

<div class="dashboard">
  <h3>Welcome, <span id="studentName"></span></h3>

  <div class="info">
    <b>Full Name:</b> <span id="fullName"></span><br>
    <b>Email:</b> <span id="email"></span><br>
    <b>Class:</b> <span id="class"></span><br>
    <b>Course:</b> <span id="course"></span><br>
    <b>Phone:</b> <span id="phone"></span><br>
  </div>

  <button id="logoutBtn">Logout</button>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDwqKHykKby2Hl4kq9YgvuE5D-m39o8s-A",
    authDomain: "registration-portal-a9e15.firebaseapp.com",
    projectId: "registration-portal-a9e15",
    storageBucket: "registration-portal-a9e15.firebasestorage.app",
    messagingSenderId: "485069236390",
    appId: "1:485069236390:web:65572074f90bd7570eec67"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const nameText = document.getElementById("studentName");
  const fullNameText = document.getElementById("fullName");
  const emailText = document.getElementById("email");
  const classText = document.getElementById("class");
  const courseText = document.getElementById("course");
  const phoneText = document.getElementById("phone");
  const logoutBtn = document.getElementById("logoutBtn");

  // ðŸ”¥ Check login status
  onAuthStateChanged(auth, async (user) => {
    if (!user) {
      window.location.href = "login.html";
      return;
    }

    // Fetch student document
    const ref = doc(db, "students", user.uid);
    const snap = await getDoc(ref);

    if (snap.exists()) {
      const data = snap.data();

      nameText.textContent = data.fullName;
      fullNameText.textContent = data.fullName;
      emailText.textContent = data.email;
      classText.textContent = data.studentClass;
      courseText.textContent = data.course;
      phoneText.textContent = data.phone;
    }
  });

  // ðŸ”¥ Logout
  logoutBtn.addEventListener("click", () => {
    signOut(auth).then(() => {
      window.location.href = "login.html";
    });
  });
</script>

</body>
</html>